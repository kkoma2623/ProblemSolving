(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{1031:function(t,e,a){"use strict";a.d(e,"a",(function(){return p}));var n=a(57),s=a.n(n),i=a(299),o=a(183);var r=new WeakMap,c=new WeakSet;class l{constructor(){c.add(this),r.set(this,{writable:!0,value:new Set})}add(t){const e=i.a.getInstance(t);return s()(this,r).has(e)||(s()(this,r).add(e),function(t,e,a){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return a}(this,c,d).call(this,e)),e}flush(){for(const{audio:t}of s()(this,r))t.pause(),t.currentTime=0;s()(this,r).clear()}}async function d(t){try{await t.play()}catch(e){if(!(e instanceof Error&&"NotAllowedError"===e.name))throw e;{const e=new o.a;document.addEventListener("click",e.resolve,{once:!0}),await e.promise,await t.play()}}await t.ended,s()(this,r).delete(t)}let u;const p=()=>({chatAudiosPlayer:u||(u=new l)})},1542:function(t,e,a){"use strict";var n=a(0),s=a(680),i=a(1031),o=a(299),r=a(658),c=a(898),l=a(17),d=a(958),u=a(2),p=Object(n.d)({name:"TestNotificationsModalAudioPlayer",components:{ProgressDots:c.a,SvgIcon:l.a},props:{chatMessage:{type:Object,default:null},testId:{type:Number,required:!0},testNotification:{type:d.a,default:null}},setup(t){const e=Object(u.a)(),a=Object(n.A)(),{chatAudiosPlayer:c}=Object(i.a)(),{notificationAudiosPlayer:l}=Object(r.a)(),{audioRef:d,currentTime:p,duration:m,format:f,playing:h}=Object(o.b)(),w=Object(n.w)(!1);return{audioRef:d,currentTime:p,duration:m,fetching:w,format:f,handleClickControl:async()=>{const e=Object(n.z)(d);if(!e||e.paused)try{w.value=!0;const{chatMessage:e,testId:a,testNotification:n}=t;if(e){const t=await Object(s.b)(a,e),{audio:n}=c.add(t);d.value=n}else if(n){const t=await Object(s.c)(a,n),{audio:e}=l.add(t);d.value=e}}finally{w.value=!1}else e.pause()},handleClickProgressBar:({currentTarget:t,offsetX:e})=>{const a=Object(n.z)(d);if(!a||!Number.isFinite(a.duration)||!(t instanceof HTMLDivElement))return;const{clientWidth:s}=t;a.currentTime=p.value=a.duration*e/s},I18n:e,playing:h,style:a}}}),m=a(3293),f=a.n(m),h=a(1);var w=Object(h.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.style.container},[a("span",{class:t.style.time},[t._v("\n    "+t._s(t.audioRef?t.format(t.currentTime):"--:--")+"\n  ")]),t._v(" "),a("div",{class:t.style.progressBar,on:{click:t.handleClickProgressBar}},[a("div",{class:t.style.track}),t._v(" "),a("div",{class:t.style.progress,style:{width:t.duration?Math.round(1e3*t.currentTime/t.duration)/10+"%":0}})]),t._v(" "),a("button",{class:t.style.control,on:{click:t.handleClickControl}},[t.fetching?a("ProgressDots",{attrs:{"transparent-background":""}}):a("SvgIcon",{attrs:{name:t.playing?"ic-player_pause":"ic-player_play","html-class":"ic-16 ic-white"}})],1)])}),[],!1,(function(t){this.$style=f.a.locals||f.a}),null,null);e.a=w.exports},3293:function(t,e,a){t.exports={"xs-down":'"max-width: 320px"',"sm-down":'"max-width: 575px"',"md-down":'"max-width: 767px"',"lg-down":'"max-width: 991px"',"xl-down":'"max-width: 1199px"',"xxl-down":'"max-width: 1599px"',"xxxl-down":'"max-width: 1999px"',danger:"#f44336",normal:"#98a8b9",success:"#4caf50",warning:"#ff9800",container:"jVyoK9sM50yIPNkM-YQcd",time:"_1WXsfOpBQ5LGVm4Q5b8tOD",progressBar:"_3jryhE9Ix6DO6S6QspfRwx",track:"HeWpTPEk5agcqpZIDQUp1",progress:"_2IfnjW45HsDqmk3GqISv8W",control:"_1tpudi409j5ROmcEZG1bi3"}},4110:function(t,e,a){"use strict";var n=a(0),s=Object(n.d)({props:{date:{type:String,required:!0}}}),i=a(4162),o=a.n(i),r=a(1);var c=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:[t.$style["notice-date"]]},[a("hr"),t._v(" "),a("span",{staticClass:"mx-2"},[t._v(t._s(t.date))]),t._v(" "),a("hr")])}),[],!1,(function(t){this.$style=o.a.locals||o.a}),null,null);e.a=c.exports},4120:function(t,e,a){"use strict";var n=a(0),s=a(1542),i=a(4110),o=a(2),r=a(85),c=a(11),l=a(9),d=Object(n.d)({name:"ChallengeToolbarNoticeModalBody",components:{AudioPlayer:s.a,DateDisplay:i.a},setup(){const t=Object(o.a)(),e=Object(l.a)(),a=Object(c.a)(),{notificationsByDate:s,setViewed:i}=Object(r.c)(),d=Object(n.a)((()=>e.state.test.isChatting)),u=Object(n.a)((()=>e.state.test.id)),p=Object(n.a)((()=>e.state.testToken.username));return Object(n.p)((()=>{i()})),{I18n:t,isChatting:d,notificationsByDate:s,style:a,testId:u,username:p}}}),u=a(4163),p=a.n(u),m=a(1);var f=Object(m.a)(d,(function(){var t,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{class:(t={},t[e.style.notificationsWrapper]=!e.isChatting,t[e.style.chatNotificationsWrapper]=e.isChatting,t)},[e.notificationsByDate.size>0?e._l(e.notificationsByDate.keys(),(function(t){return n("div",{key:t},[n("DateDisplay",{attrs:{date:t}}),e._v(" "),e._l(e.notificationsByDate.get(t),(function(a,s){var i,o;return n("div",{key:s,class:[e.style.noticeWrapper,"py-3",(i={},i[e.style.lastNotice]=e.notificationsByDate.get(t).length-1===s,i)]},[a.title?n("div",[n("div",{class:[e.style.noticeType,"mb-2"]},[n("div",{class:e.style.announcement},[n("div",{class:[e.style.typeIconWrapper,"mr-2",(o={},o[e.style.hasNotificationAudio]=a.hasNotificationAudio,o)]},[a.hasNotificationAudio?n("SvgIcon",{attrs:{name:"ic-announcement-voice","html-class":"ic-12"}}):n("SvgIcon",{attrs:{name:"ic-campaign-16","html-class":"ic-12"}})],1),e._v("\n              "+e._s(e.I18n.t(a.hasNotificationAudio?"test.spa.notice_audio":"test.spa.notice"))+"\n            ")]),e._v(" "),n("span",{class:e.style.date},[e._v(e._s(a.createdAt))])]),e._v(" "),n("div",{class:[e.style.noticeTitle,"mb-1"]},[e._v("\n            "+e._s(a.title)+"\n          ")]),e._v(" "),n("div",{class:e.style.noticeContent},[e._v("\n            "+e._s(a.content)+"\n          ")]),e._v(" "),a.hasNotificationAudio?n("AudioPlayer",{class:e.style.player,attrs:{"test-id":e.testId,"test-notification":a}}):e._e()],1):n("div",[n("div",{class:[e.style.noticeType,"mb-2"]},[n("div",{class:e.style.proctor},[n("div",{class:[e.style.proctorIconWrapper,"mr-2"]},[n("SvgIcon",{attrs:{name:"ic-interview-fill-16","html-class":"ic-12"}})],1),e._v("\n              "+e._s(e.I18n.t("test.spa.proctor_message"))+"\n            ")]),e._v(" "),n("span",{class:e.style.date},[e._v(e._s(a.createdAt))])]),e._v(" "),n("div",{class:[e.style.noticeTitle,"mb-1"]},[e._v("\n            "+e._s(e.I18n.t("test.spa.proctor_description",{username:e.username}))+"\n          ")]),e._v(" "),n("div",{class:e.style.noticeContent},[e._v("\n            "+e._s(a.content)+"\n          ")]),e._v(" "),a.hasNotificationAudio?n("AudioPlayer",{class:e.style.player,attrs:{"test-id":e.testId,"test-notification":a}}):e._e()],1)])}))],2)})):n("div",{class:e.style.empty},[n("SvgIcon",{attrs:{name:"ic-inbox-message","html-class":"mb-2 ic-40"}}),e._v("\n    "+e._s(e.I18n.t("test.spa.no_announcement"))+"\n  ")],1)],2)}),[],!1,(function(t){this.$style=p.a.locals||p.a}),null,null);e.a=f.exports},4127:function(t,e,a){t.exports={"xs-down":'"max-width: 320px"',"sm-down":'"max-width: 575px"',"md-down":'"max-width: 767px"',"lg-down":'"max-width: 991px"',"xl-down":'"max-width: 1199px"',"xxl-down":'"max-width: 1599px"',"xxxl-down":'"max-width: 1999px"',danger:"#f44336",normal:"#98a8b9",success:"#4caf50",warning:"#ff9800"}},4162:function(t,e,a){t.exports={"xs-down":'"max-width: 320px"',"sm-down":'"max-width: 575px"',"md-down":'"max-width: 767px"',"lg-down":'"max-width: 991px"',"xl-down":'"max-width: 1199px"',"xxl-down":'"max-width: 1599px"',"xxxl-down":'"max-width: 1999px"',danger:"#f44336",normal:"#98a8b9",success:"#4caf50",warning:"#ff9800","notice-date":"_3KIMRFkIm5NtaCU9MK23KT"}},4163:function(t,e,a){t.exports={"xs-down":'"max-width: 320px"',"sm-down":'"max-width: 575px"',"md-down":'"max-width: 767px"',"lg-down":'"max-width: 991px"',"xl-down":'"max-width: 1199px"',"xxl-down":'"max-width: 1599px"',"xxxl-down":'"max-width: 1999px"',danger:"#f44336",normal:"#98a8b9",success:"#4caf50",warning:"#ff9800","notifications-wrapper":"_3HXBEV_tbM3By3uXITf4uu","chat-notifications-wrapper":"_2SSOK7S2qoFKUn1pvSKmQN","notice-wrapper":"_1HnTJ2w0SB7QpbXnWKQRqu","notice-type":"_1NI396hPgoUzT12D2i5sU5",date:"_2TA2mVcodA1rflIy2moZCc",announcement:"_1Ecrkcni74lvCrqGDX-1gT","type-icon-wrapper":"_2Q4OF0IlOMSBTHEITItECW",hasNotificationAudio:"_3fzcdmvFQZU0zA96ILX0_i",proctor:"_35EcbPQwbw1fPAdq0ZcV2Q","proctor-icon-wrapper":"_29HNkZF2a6u0Aln2-UYwdA","notice-title":"_1t5JehJqRmpbIc1XjZTA0m","notice-content":"_32DKwdpo7YmzjncTZuNfaP","last-notice":"_3g23YevBy7acwZXKaksAO",player:"_319OivIQkHGriVKclkXUD8",empty:"_1y_4JDHfTjZqWJBgQ9_DQ2"}},4165:function(t,e,a){"use strict";a(4127)},4299:function(t,e,a){"use strict";a.r(e);var n=a(0),s=a(47),i=a.n(s),o=a(76),r=a(200),c=a(4120),l=a(2),d=a(85),u=Object(n.d)({name:"ChallengeToolbarNoticeModal",components:{Modal:o.a,ModalTitle:r.a,NoticeModalBody:c.a},setup(){const t=Object(n.w)(null),e=Object(l.a)(),{modalOpen:a,setModalOpen:s}=Object(d.c)();return Object(n.B)(a,i.a.throttle((e=>{var a,n;return e?null===(a=t.value)||void 0===a?void 0:a.show():null===(n=t.value)||void 0===n?void 0:n.hide()}),500)),{modal:t,hide:()=>s(!1),I18n:e}}}),p=(a(4165),a(1)),m=Object(p.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"challenge-toolbar-notice"},[a("Modal",{ref:"modal",attrs:{"html-class":"modal-overflow-scroll"},on:{onHide:t.hide}},[a("template",{slot:"title"},[a("ModalTitle",{attrs:{title:t.I18n.t("test.spa.notice")},on:{close:t.hide}})],1),t._v(" "),a("div",{attrs:{slot:"body"},slot:"body"},[a("NoticeModalBody")],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.hide}},[t._v("\n        "+t._s(t.I18n.t("actions.close"))+"\n      ")])])],2)],1)}),[],!1,null,null,null);e.default=m.exports},680:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"e",(function(){return c})),a.d(e,"a",(function(){return l}));var n=a(89),s=a.n(n);const i=async(t,e)=>{const a=l.createChatAudioGetObjectPresignedUrlCacheKey(e);if(l.has(a)){const t=l.get(a),{isExpiredPresignedUrl:e}=l;if(!e(t))return t}const{data:{url:n}}=await s.a.get(["/api/tests",t,"chat_messages",e.id,"file_url"].join("/"));return l.set(a,n).notify(a,n),n},o=async(t,e)=>{const{type:a}=e,n=(a.includes("webm")?".webm":a.includes("mp4")&&".aac")||".webm",{data:{url:i}}=await s.a.post(`/api/tests/${t}/chat_messages/create_audio_upload_url`,{ext:n});await s.a.put(i,e,{headers:{"content-type":e.type}});const{pathname:o}=new URL(i);return o},r=async(t,e)=>{const{__typename:a="TestNotification",id:n}=e,i=l.createNotificationAudioGetObjectPresignedUrlCacheKey({__typename:a,id:n});if(l.has(i)){const t=l.get(i),{isExpiredPresignedUrl:e}=l;if(!e(t))return t}const{data:{url:o}}=await s.a.get(["/api/v1/tests",t,"TestNotification"===a?"test_notifications":"TestNotificationSchedule"===a&&"test_notification_schedules",n,"audio_url"].join("/"));return l.set(i,o).notify(i,o),o},c=async(t,e)=>{const{type:a}=e,n=(a.includes("webm")?".webm":a.includes("mp4")&&".aac")||".webm",{data:{url:i}}=await s.a.post(`/api/v1/tests/${t}/test_notifications/presigned_url`,{ext:n});await s.a.put(i,e,{headers:{"content-type":e.type}});const{pathname:o}=new URL(i);return o},l=Object.assign(new Map,{createChatAudioGetObjectPresignedUrlCacheKey:t=>new URLSearchParams({__typename:"ChatMessage",id:String(t.id)}).toString(),createNotificationAudioGetObjectPresignedUrlCacheKey(t){const{__typename:e,id:a}=t;return new URLSearchParams({__typename:e,id:a}).toString()},isExpiredPresignedUrl:t=>{const{searchParams:e}=new URL(t),a=(()=>{if(e.has("Expires"))return new Date(1e3*Number(e.get("Expires")));const t=e.get("X-Amz-Date"),a=e.get("X-Amz-Expires"),n=/(?<year>\d{4})(?<month>\d{2})(?<date>\d{2})T(?<hours>\d{2})(?<minutes>\d{2})(?<seconds>\d{2})Z/.exec(t||"");if(null!==n&&void 0!==n&&n.groups){const{year:t,month:e,date:s,hours:i,minutes:o,seconds:r}=n.groups;return new Date(+t,+e,+s-1,+i,+o,+r+Number(a))}return null})();return!!a&&a<new Date},notify(t,e){this.subscribers.forEach((a=>{a(t,e)}))},subscribe(t){const{subscribers:e}=this;return e.add(t),()=>e.delete(t)},subscribers:new Set})},898:function(t,e,a){"use strict";var n=a(0),s=Object(n.d)({name:"TestAudioProgressDots",props:{color:{type:String,default:null},idle:{type:Boolean},transparentBackground:{type:Boolean}},setup(){const t=1.5;return{dotRadius:t,dots:3,duration:1400,getCenterX:t=>3+4.5*t,getValues:t=>[!1].concat(Array.from({length:3}).map(((e,a)=>t<a+2))).map(Number).join(";"),primaryColor:"#0078FF",radius:12,viewBox:24}}}),i=a(1),o=Object(i.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("svg",{attrs:{viewBox:[0,0,t.viewBox,t.viewBox].join(" "),xmlns:"http://www.w3.org/2000/svg"}},[a("circle",{attrs:{cx:t.radius,cy:t.radius,r:t.radius,fill:t.transparentBackground?"transparent":t.primaryColor}}),t._v(" "),t._l(t.dots,(function(e){return a("circle",{key:e,attrs:{cx:t.getCenterX(e),cy:t.radius,r:t.dotRadius,fill:t.color||"white","fill-opacity":t.idle&&!t.color?.4:1}},[t.idle?t._e():a("animate",{attrs:{attributeName:"fill-opacity",values:t.getValues(e),dur:t.duration+"ms",repeatCount:"indefinite"}})])}))],2)}),[],!1,null,null,null);e.a=o.exports},958:function(t,e,a){"use strict";a.d(e,"a",(function(){return n}));class n{constructor(t,e){const{__typename:a,id:n,title:s,content:i,hasNotificationAudio:o,sendAt:r,failed:c=!1}=t;Object.assign(this,{__typename:a,id:n,title:s,content:i,hasNotificationAudio:o||!1,sendAt:r?new Date(r):new Date,failed:c,cursor:e||null})}get status(){const{__typename:t,failed:e}=this;return("TestNotification"===t?"sent":"TestNotificationSchedule"===t&&!e&&"scheduled")||"error"}static new(t,e){return new n(t,e)}}}}]);
//# sourceMappingURL=37-d9ff39a0919616a8bd01.chunk.js.map